# 寫給PM、RD與設計師的設計需求分析

這是一篇關於"**寫給PM、RD與設計師的設計需求分析**"一書的閱讀紀錄

>~~~
> 一種關於設計需求的分析手法，作者認為傳統的需求收集會有許多潛在的問題。認為需求必須經過整理
> 並加以設計，並且需思考與現行應用系統的協作，以期建立一致性的IT架構。
> 貫穿全文，感覺該書仍有多處與MDA系統建模方法有諸多相似的地方，只是該書以其獨有的脈絡分析技巧來
> 創建出另一種獨樹一格的系統分析方法。因此，後續的紀錄內容亦會搭配 MDA 的建模知識進行撰寫，
> 即便書中隻字未提 MDA 的系統建模。
>~~~

## 傳統需求訪談、收集的問題
傳統的系統開發第一個步驟都是收集來自四面八方的需求，而收集的方式無非是利害關係人的逐一訪談。
但常見的問題如下：
 - 常常得到的回答都是可能、應該，很難有一個明確的答案
 - 多個利害關係人對於相同的問題卻有不一樣的答案
 - 無法找齊所有相關人員，導致重要訊息遺漏
 - 來自於高階人員的錯誤答案，卻又無人敢勇於指正
 - 分析時的過度解讀或理解錯誤
 - 最後得到的需求確認並非審核者深思熟慮後的決定
 - 相關人員對於所提需求能夠解決問題的程度過於高估<br/>
 **於是乎最後的結果就是需求一變再變，進而造成計畫延遲與成本超支。**

就如同房屋設計必須先出現才會有後續的根基設計方式。不知曉建造的房屋類型，自然無法判斷如何
設計根基。應用程式的設計也一樣，其除了需要能夠反映企業解決方案，更要能支撐解決方案。良好的需求
分析絕對不是一堆雜亂無章的清單而已，你必須有方法接著設計它。


## 設計即設計企業的解決方案
什麼是設計？它是一連串的理解 > 假設 > 分析 > 修正，反覆這些步驟，持續的修正。

### 常用的設計手法
 - 臨時設計
一種無正規方式的設計，可能只是一個想法或草圖案例後就開始建造。當專案規模足夠小或者只是在
開發大型產品的諸多小版本之一，加上沒有依賴的專案、利害關係人配合度又高的同時，就可以簡單
使用這種臨時設計的方式。

 - 計劃設計
一種事先完整規劃後才進行開發。這種方式在 IT 領域其實已經大量使用。只是要注意，可能不是那麼
適合使用在創新的應用上。因為創新也意味著需求可能不穩定，若在耗費時間人力分析後才發現問題，
通常就會有鉅額的成本。

 - 工程設計
一種涵蓋正式分析步驟的設計手法，也是種先規畫後開發的模式，但不同的是須施以階層式的設計，每
一層的元件組合皆須明白闡述並經過測試，一但發現問題便立即回饋至上層即時處理並適當變更。其中
各層測試重點如下：
   - 需滿足高層設計需求(好比飛機需滿足其引擎性能的要求)
   - 需合乎外部規範要求(好比飛機引擎需合乎噪音限制的規範)
   - 探索過往未知的新問題

事後發現問題總是比較棘手，並且容易出現風險衍生性高的狀況，諸如無法重新設計或引發新問題所產生
的骨牌效應。這類問題實際上難以規避，但藉由工程設計的手法，可以讓問題盡可能在早期就捕抓到，因此
比起計劃設計總是來的牢靠。

相對於階層式的工程設計，業界仍是偏向使用計劃設計，但這類設計手法在遇到專案規模大且複雜時，往
往相對出現複雜的設計而難以在這龐然大物中即時發現可能的問題。

因而，書中核心的脈絡分析部分將會嵌入在一個工程設計步驟中來進行設計。另外，在整個設計階層的上層還以執行一段整合設計
，用以決定現存應用服務的取捨。如此，才能訂定出可重複利用的服務，進一步實現對現行 IT 架構的支持

## 階層式設計
<img src="https://raw.githubusercontent.com/Internaltide/readingNotes/master/ContextAnalysis/images/EngineerDesign.png" style="width:35%;height:35%" /><br/>
上面這張階層設計圖是作者用來實踐工程設計的方式，又稱為六塊模型。作者自喻其雖非典型工程階層設計，但仍是立基於逐層設計的概念所延伸設計，因此可以做到完整、一致及可追溯等特性以達到工程設計應有的品質。其與標準工程階層設計那種逐層的元件分割有所不同，從整合設計往下到實作間的過程其實是種由脈絡設計轉換到介面、資料庫綱要及技術的過程。

### 使用案例分析**use case**
這是業界常用的需求分析方法，但作者認為雖然使用案例圖可以給予客戶一個說明的輪廓，但當專案規模龐大時，所產生的案例說明文件可能會相當龐大，反而導致開發人員難以從中的到幫助。另外，由於傳統使用案例分析並未考量到原子性及技術層面，因此在專案時間成本的估計會有相當大的問題。因此作者仍是推薦使用脈絡設計分析的手法。

### 脈絡設計**context design**
脈絡設計必須能夠解釋 IT 開發的企業需求，需要能從其中看出組織要應用軟體做什麼事、任務需要那些資料表及有哪些相關使用者。換句話說，脈絡設計其實就是一套整合任務、使用者群組及資料表的設計。其焦點在於資料如何支援企業流程及誰做了什麼事，
最終用來確保任務是營運所需要的並控管使用者供作量，避免給予過重工作量。

**<分析要素>**
#### 任務
脈絡設計的首要任務就是找出有哪些具有原子性且不可分割的任務。所謂原子性則是指某人於某刻執行之不可分割的工作。當使用者可以擱置某項工作(或者說是我們想支援這樣的功能)，並於一段時間後再回來完成時，則該工作被就被視為不具原子性。它應該繼續進行拆解，例如切割成執行工作、暫存工作及完成工作三項任務。下面提供了幾項找尋任務的切入點，試圖以不同的角度來挖掘出所有可能的任務。
 - 企業流程<br/>
   企業流程中的各個活動都可能將來的系統任務，這是傳統找尋使用案例的主要方式之一。當功能需求涉及企業流程時，就可以依此方式進行分析並隨時思考任務是否具備原子性。
 - 沒有明確流程的單一功能需求
   可依下面幾種面向來切入：
     - 商業服務<br/>
       直接站在服務提供商的角度，思考用戶可能會提出那些需求，這也可能成為系統任務
     - 資源管理<br/>
       在所有業務活動的過程中，勢必有一些資源狀態的變動，找出這些讓資源進出狀態的活動任務
     - 事務的監控管理<br/>
       若功能需求類似於一種檢討、監控時，可先試著思考以下幾點：
         - 監控方式隸屬定期或事件觸發
         - 級別提升程序的規則為何？
         - 那些人可以看到資料？這在組織各階層都可能有所不同<br/>

        從管理層面的角度來看，這些監控管理需求也都可能影響最後的任務定義。

#### 用戶群組
就是找出有哪些用戶群組，透過不同的群組定義，他們會有不同的系統存取權限、畫面及任務集合。另外，用群組代替使用者的好處是可以簡化脈絡圖上的關聯。

#### 資料表
只要找出任務可能相依的資料表，但尚不須要定義出詳細的 Schema

#### 任務間的訊息傳遞
任務除了共享資料外，彼此間亦可能會有訊息上的傳遞，

#### 任務相依關係
很多時候任務並無法單獨存在，尤其在一個流程上的任務通常是一環扣一環，彼此相依的。某個任務的結果會決定下面一個任務的處理方式。詳細了解任務間的相依性可以確認現有任務集合是否足以支持企業流程的運作。
<br/>

**<產出>**<br/>
脈絡設計圖<br/>

**<MDA 對應>**<br/>
CIM-1 **定義企業流程，產出企業UC**<br/>
CIM-2 **分析企業流程，產出活動圖**<br/>
脈絡分析中挖掘任務的探討其實就約略跨越了 CIM-1 及 CIM-2 兩個 MDA 步驟，在本書中在找尋任務上有了更多元的切入點，而不僅僅只有企業流程。但相對於本書似乎預設已經存在的企業流程，MDA對於如何定義企業流程則有了更多的著墨。<br/>
PS. 其實筆者不喜歡企業UC這用詞，它與後續的系統UC有很大的粒度差異，我喜歡稱之為找尋企業的核心業務，一種顧客與企業的互動。聽起來更直覺好懂不會混淆<br/>

CIM-3 **定義系統範圍，產出系統UC圖**<br/>
整個脈絡設計涵蓋了傳統的使用案例分析，除了對於任務有了更嚴謹的規範外(像是原子性)，也多了資料表等更多的分析元素。

PIM-1 **分系系統流程，產出系統UC敘述**<br/>
脈絡設計也針對每項任務產出任務說明文件，內容包含任務細節、執行用戶、執行前顯示資料、執行結果、敘述、規則及附註等等。

PIM-2 **分析企業規則，產出狀態圖**<br/>
因為資源的狀態遷移也是書中所述之找尋任務的切入點之一，因此狀態圖的實作可能也是需要的，因此認為脈絡設計應該也涵蓋了 PIM-2 階段。

### 整合設計
整合設計是一個任務與資料表分配與安排的過程，你必須將任務分配到各種應用、將資料表安排到各個資料庫中。

#### 任務分配
可供分配的應用一般不出下列三種：
 - 應用程式：通常有終端使用者，像是線上的網頁應用都算是應用程式。
 - 服務程式：指的是可以被應用程式呼叫使用的服務程式，不會有直接使用者。
 - 批次處理程式：經由某種時間事件所觸發的，像是定時觸發的應用排程都算是。<br/>

定義應用程式的簡易方式：<br/>
組織應用的依據以功能性為主、使用者需要為輔。依功能性將任務分組後，對於少數介於模糊地帶、安放到多個組別都合理的任務，則改依使用者為考量，擇一應用置放，以達成使用便利性為要。

服務程式的必要考量因素：<br/>
 - 邏輯與資料的再利用
 - 執行效率
 - 安全性
 - 大型專案的拆解<br/>

服務與應用的合適規模：<br/>
   - 足以滿足應用程式的客戶端即可
   - 需確保資料正確性<br/>
     須確保每份資訊只有一個可信賴版本。某些資料表可能到處都需要，像是客戶表、產品表等，要避免這些資料有過多的副本，無論是效能或安全性，只複製所需的資訊即可。若多個資料庫都存在相同資料表，將容易產生資料不一致的問題。
   - 從應用程式將服務提煉出來
     分割出來的服務還可以交由小型團隊進行處理，作為職責劃分的依據

#### 脈絡模型
如果專案不是從零開始，勢必與現有應用程式進行整合，那麼從現有應用程式出發來建構一套脈絡設計是值得的。這種脈絡設計被稱之為脈絡模型，將其與新設計進行比較，可以找出有用的差異點。

**<MDA 對應>**<br/>
PIM-3 定義靜態結構，產出類別圖<br/>
會認為整合設計可對應 MDA 的 PIM-3，主要還是因為覺得整合設計中的服務程式定義部分有點像在定義類別，雖沒有實際的內容定義(屬性、方法)與結構關係，但若是專案結構非常複雜時，單張整合設計圖是很難呈現物件關係的，因此類別圖可能還是需要，因此實務可以在整合設計過程中視需要將 PIM-3 整合在一起實作。

### 技術設計
主要為一些用來滿足非功能性需求的設計，諸如版控工具的選擇、備份方式等。也可能是一些可以簡化程式設計的方案，像是框架選用、第三方協作服務使用或軟體應用等。最終用來確保執行效能與可靠性。

**<常見的非功能性需求>**<br/>
 - 生產力與回應時間
 - 妥善率
 - 災害復原
 - 安全設計與監控
 - 操作、管理的容易度
 - 新版軟硬體的有效控制
 - 成本目標

### 使用者介面設計
使用者介面設計則是使用容易的重要關鍵，也能在此階段作出重要回饋，其對於脈絡設計來說是個很好的檢驗，讓設計更加完整。
Detail Pendding!!

### 資料庫設計
資料庫設計應該保證整個組織的資料一致性，相同的資料不應該在多處進行輸入。
Detail Pendding!!

## 脈絡設計實際應用
## 降低正規需求與企業實際需要的差距
## 最重要的五類使用者及其關心事項
## 決定如何處裡舊的應用程式


> ~~~
> 筆者自己的第一版實務步驟
> ~~~

## 脈絡分析步驟:
 - 找出企業核心業務並繪製企業流程活動圖(CIM-1、CIM-2)
 - 繪製狀態機(PIM-2)
 - 找出任務(依前兩步驟結果找出可能任務，CIM-3 開始)
 - 任務分配至應用 **(提前拉到脈絡設計來處理，可做為脈絡設計圖分割的依據)**<br/>
組織應用的依據以功能性為主、使用者需要為輔。依功能性將任務分組後，對於少數介於模糊地帶、安放到多個組別都似乎合理的任務，改依使用者為考量，擇一應用，以達成使用便利性為要。
 - 脈絡設計 **(重複實作，每個應用產出一張脈絡設計圖)**
   - 組織上半部脈絡圖，用戶群組與任務間的關係<br/>
實作時若採用RBAC權限設計，用戶群組與任務的關係或許可作為預設的角色權限定義。
   - 組織下半部脈絡圖，資料表與任務間的關係，可先勾勒出與外部系統溝通的邊界服務
   - 勾勒出任務間可能的訊息傳遞行為
 - 脈絡整合關係總表<br/>
將脈絡關係整進總表，方便做整合設計

## 整合設計步驟
 - 任務分配至應用並更新總表
   - 在MVC框架下，一個應用可以對應一個控制器物件
   - 完成整合設計圖的群組與應用間的Mapping
 - 資料表安排到DB
   - 待整理!!
 - 定義服務程式
   - 依資料需求來組織，產出第一版服務程式
   - 繪製類別圖並返饋調整服務列表，如增加一些需要的邊界物件
   - 完成整合設計圖的資料表與服務程式的Mapping
 - 完成應用與服務程式間的Mapping，並適當調整服務程式的組織方式
 - 整合設計圖過於複雜，可試著將圖進行切割，以一個應用一張圖為主。



 <img src="https://raw.githubusercontent.com/Internaltide/readingNotes/master/ContextAnalysis/images/RN0001.jpg" />